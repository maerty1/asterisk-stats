<div align="center">

# üìä Asterisk Queue Analytics

**–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –æ—á–µ—Ä–µ–¥–µ–π Asterisk**

[![Version](https://img.shields.io/badge/version-1.1.0-4f46e5?style=for-the-badge)](https://github.com/maerty1/asterisk-stats)
[![License](https://img.shields.io/badge/license-MIT-10b981?style=for-the-badge)](LICENSE)
[![Node](https://img.shields.io/badge/node-16%2B-339933?style=for-the-badge&logo=node.js)](https://nodejs.org/)
[![MySQL](https://img.shields.io/badge/mysql-8.0+-4479A1?style=for-the-badge&logo=mysql&logoColor=white)](https://www.mysql.com/)
[![Docker](https://img.shields.io/badge/docker-ready-2496ED?style=for-the-badge&logo=docker&logoColor=white)](https://www.docker.com/)
[![Swagger](https://img.shields.io/badge/swagger-docs-85EA2D?style=for-the-badge&logo=swagger&logoColor=black)](http://localhost:3000/api/docs/)

[–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](#-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è) ‚Ä¢ [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#-–±—ã—Å—Ç—Ä–∞—è-—É—Å—Ç–∞–Ω–æ–≤–∫–∞) ‚Ä¢ [API](#-api-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è) ‚Ä¢ [Docker](#-docker) ‚Ä¢ [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥](#-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)

</div>

---

## ‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

<div align="center">

### üéØ –ú–æ—â–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ | üîÑ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–∑–≤–æ–Ω–æ–≤ | üìß Email-–æ—Ç—á–µ—Ç—ã | üé® –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π UI

</div>

**Asterisk Queue Analytics** ‚Äî —ç—Ç–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ —Ä–∞–±–æ—Ç—ã –∫–æ–ª–ª-—Ü–µ–Ω—Ç—Ä–∞ –Ω–∞ –±–∞–∑–µ Asterisk. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∑–≤–æ–Ω–∫–∞–º, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–∑–≤–æ–Ω—ã –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –æ—Ç—á–µ—Ç—ã.

### üéØ –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìà **–ü–æ–ª–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–ª–ª-—Ü–µ–Ω—Ç—Ä–∞** ‚Äî –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- üîÑ **–£–º–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–∑–≤–æ–Ω–æ–≤** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–∑–≤–æ–Ω–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –∞–≥–µ–Ω—Ç–æ–≤
- üìä **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏** ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ —á–∞—Å–∞–º –∏ –ø–µ—Ä–∏–æ–¥–∞–º
- üéµ **–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π** ‚Äî –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∞—É–¥–∏–æ-–ø–ª–µ–µ—Ä –¥–ª—è –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤
- üìß **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á–µ—Ç—ã** ‚Äî –µ–∂–µ–¥–Ω–µ–≤–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –Ω–∞ email
- üöÄ **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** ‚Äî –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- üé® **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** ‚Äî —Ç–µ–º–Ω–∞—è —Ç–µ–º–∞ –≤ —Å—Ç–∏–ª–µ Linear/Raycast
- üìñ **Swagger API** ‚Äî –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è REST API
- üìä **Prometheus –º–µ—Ç—Ä–∏–∫–∏** ‚Äî –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- üê≥ **Docker Ready** ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –∏–∑ –∫–æ—Ä–æ–±–∫–∏
- üîÑ **CI/CD** ‚Äî GitHub Actions –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

---

## üöÄ –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js 14.0 –∏–ª–∏ –≤—ã—à–µ
- MySQL/MariaDB —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö Asterisk
- –î–æ—Å—Ç—É–ø –∫ —Ç–∞–±–ª–∏—Ü–∞–º `asteriskcdrdb.cdr` –∏ `asteriskcdrdb.queuelog`

### –®–∞–≥–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
# 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/maerty1/asterisk-stats.git
cd asterisk-stats

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env
nano .env  # –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª —Å –≤–∞—à–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
npm start
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: **http://localhost:3000**

> üí° **–°–æ–≤–µ—Ç**: –î–ª—è production –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ [PM2](https://pm2.keymetrics.io/) –∏–ª–∏ [systemd](https://www.freedesktop.org/software/systemd/man/systemd.service.html)

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ `.env`

```env
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DB_HOST=localhost
DB_USER=freepbxuser
DB_PASS=your_password_here
DB_NAME=asterisk
DB_CONNECTION_LIMIT=20

# –°–µ—Ä–≤–µ—Ä
PORT=3000
TZ=Europe/Moscow

# Email (–¥–ª—è –æ—Ç—á–µ—Ç–æ–≤)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your_email@gmail.com
SMTP_PASS=your_app_password
EMAIL_CRON_SCHEDULE=59 23 * * *  # –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 23:59

# –ó–∞–ø–∏—Å–∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
RECORDINGS_PATH=/var/spool/asterisk/monitor
```

> üìñ –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å–º. –≤ —Ñ–∞–π–ª–µ [`.env.example`](.env.example)

---

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–ª–ª-—Ü–µ–Ω—Ç—Ä–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| **–í—Å–µ–≥–æ –∑–≤–æ–Ω–∫–æ–≤** | –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ö–æ–¥—è—â–∏—Ö –∑–≤–æ–Ω–∫–æ–≤ –∑–∞ –ø–µ—Ä–∏–æ–¥ |
| **–ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç–≤–µ—Ç–∞** | –î–æ–ª—è –æ—Ç–≤–µ—á–µ–Ω–Ω—ã—Ö –∑–≤–æ–Ω–∫–æ–≤ –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ |
| **SLA (20 —Å–µ–∫)** | –ü—Ä–æ—Ü–µ–Ω—Ç –∑–≤–æ–Ω–∫–æ–≤, –æ—Ç–≤–µ—á–µ–Ω–Ω—ã—Ö –≤ —Ç–µ—á–µ–Ω–∏–µ 20 —Å–µ–∫—É–Ω–¥ |
| **–ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ** | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–æ—Ç–≤–µ—á–µ–Ω–Ω—ã—Ö –∑–≤–æ–Ω–∫–æ–≤ |
| **ASA** | –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –∑–≤–æ–Ω–æ–∫ (Average Speed of Answer) |
| **Abandon Rate** | –ü—Ä–æ—Ü–µ–Ω—Ç –∑–∞–±—Ä–æ—à–µ–Ω–Ω—ã—Ö –∑–≤–æ–Ω–∫–æ–≤ |

### üîÑ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–∑–≤–æ–Ω–æ–≤

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç:

- ‚úÖ **–ü–µ—Ä–µ–∑–≤–æ–Ω–∏–ª —Å–∞–º** ‚Äî –∫–ª–∏–µ–Ω—Ç –ø–µ—Ä–µ–∑–≤–æ–Ω–∏–ª –≤ —Ç–µ—á–µ–Ω–∏–µ 2 —á–∞—Å–æ–≤ –ø–æ—Å–ª–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω–æ–≥–æ –∑–≤–æ–Ω–∫–∞
- üìû **–ü–µ—Ä–µ–∑–≤–æ–Ω–∏–ª–∏ –º—ã** ‚Äî –∞–≥–µ–Ω—Ç –ø–µ—Ä–µ–∑–≤–æ–Ω–∏–ª –∫–ª–∏–µ–Ω—Ç—É –≤ —Ç–µ—á–µ–Ω–∏–µ 2 —á–∞—Å–æ–≤
- ‚è∏Ô∏è **–ù–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω** ‚Äî –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–≤–æ–Ω–∫–∏ –±–µ–∑ –ø–µ—Ä–µ–∑–≤–æ–Ω–æ–≤

### üìä –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

- üìà –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–≤–æ–Ω–∫–æ–≤ –ø–æ —á–∞—Å–∞–º
- üìâ –¢—Ä–µ–Ω–¥—ã –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
- üìã –î–µ—Ç–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∑–≤–æ–Ω–∫–æ–≤ —Å –ø–æ–∏—Å–∫–æ–º, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- üé® –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ç–µ–º–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –ø–ª–∞–≤–Ω—ã–º–∏ –∞–Ω–∏–º–∞—Ü–∏—è–º–∏

### üìß Email-–æ—Ç—á–µ—Ç—ã

- ‚è∞ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –µ–∂–µ–¥–Ω–µ–≤–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
- üë• –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –¥–ª—è –∫–∞–∂–¥–æ–π –æ—á–µ—Ä–µ–¥–∏ –æ—Ç–¥–µ–ª—å–Ω–æ
- üìÑ HTML-—Ñ–æ—Ä–º–∞—Ç —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
- üìä –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ CSV –∏ Excel

---

## üìñ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –æ—á–µ—Ä–µ–¥–∏

1. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∫–ª–∞–¥–∫—É **"–í—Ö –æ—á–µ—Ä–µ–¥—å"**
2. –í—ã–±–µ—Ä–∏—Ç–µ –æ—á–µ—Ä–µ–¥—å –∏–∑ —Å–ø–∏—Å–∫–∞
3. –£–∫–∞–∂–∏—Ç–µ –ø–µ—Ä–∏–æ–¥ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±—ã—Å—Ç—Ä—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã:
   - üìÖ –°–µ–≥–æ–¥–Ω—è
   - üìÖ –í—á–µ—Ä–∞
   - üìÖ –ù–µ–¥–µ–ª—è
   - üìÖ –ú–µ—Å—è—Ü
4. –ù–∞–∂–º–∏—Ç–µ **"–ê–Ω–∞–ª–∏–∑"**

### –ë—ã—Å—Ç—Ä—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã

```javascript
// –ë—ã—Å—Ç—Ä—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –¥–æ—Å—Ç—É–ø–Ω—ã –ø—Ä—è–º–æ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
–°–µ–≥–æ–¥–Ω—è   ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É
–í—á–µ—Ä–∞     ‚Üí –ü—Ä–µ–¥—ã–¥—É—â–∏–π –¥–µ–Ω—å
–ù–µ–¥–µ–ª—è    ‚Üí –ü–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π
–ú–µ—Å—è—Ü     ‚Üí –ü–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ email-–æ—Ç—á–µ—Ç–æ–≤

1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **üìß Email —Ä–∞—Å—Å—ã–ª–∫–∞**
2. –í—ã–±–µ—Ä–∏—Ç–µ –æ—á–µ—Ä–µ–¥—å
3. –î–æ–±–∞–≤—å—Ç–µ email-–∞–¥—Ä–µ—Å –ø–æ–ª—É—á–∞—Ç–µ–ª—è
4. –û—Ç—á–µ—Ç—ã –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–≥–ª–∞—Å–Ω–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é

---

## üìñ API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### Swagger UI

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É:

```
http://localhost:3000/api/docs/
```

OpenAPI JSON —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è:
```
http://localhost:3000/api/docs.json
```

### –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| `GET` | `/api/health` | –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è |
| `GET` | `/api/health/live` | Liveness probe (Kubernetes) |
| `GET` | `/api/health/ready` | Readiness probe (Kubernetes) |
| `GET` | `/api/metrics` | Prometheus –º–µ—Ç—Ä–∏–∫–∏ |
| `GET` | `/api/settings` | –ü–æ–ª—É—á–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |
| `POST` | `/api/settings` | –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |
| `POST` | `/rankings` | –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–π—Ç–∏–Ω–≥ –æ—á–µ—Ä–µ–¥–µ–π |
| `POST` | `/rankings/export-excel` | –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–π—Ç–∏–Ω–≥–∞ –≤ Excel |

### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞

```bash
# –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–π—Ç–∏–Ω–≥ –æ—á–µ—Ä–µ–¥–µ–π
curl -X POST http://localhost:3000/rankings \
  -H "Content-Type: application/json" \
  -d '{"start_date": "2026-01-01", "end_date": "2026-01-15"}'

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
curl http://localhost:3000/api/health
```

---

## üê≥ Docker

### –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

```bash
# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
docker-compose up -d

# –¢–æ–ª—å–∫–æ —Å–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
docker build -t asterisk-stats .

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker run -d -p 3000:3000 --env-file .env asterisk-stats
```

### Docker Compose

```yaml
version: '3.8'
services:
  app:
    build: .
    ports:
      - "3000:3000"
    environment:
      - DB_HOST=db
      - DB_USER=${DB_USER}
      - DB_PASS=${DB_PASS}
    depends_on:
      - db
  db:
    image: mariadb:10.6
    environment:
      - MYSQL_ROOT_PASSWORD=${DB_ROOT_PASSWORD}
      - MYSQL_DATABASE=${DB_NAME}
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Prometheus –º–µ—Ç—Ä–∏–∫–∏

–ú–µ—Ç—Ä–∏–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:3000/api/metrics`

#### –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----|----------|
| `asterisk_stats_http_requests_total` | Counter | HTTP –∑–∞–ø—Ä–æ—Å—ã |
| `asterisk_stats_http_request_duration_seconds` | Histogram | –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ |
| `asterisk_stats_db_queries_total` | Counter | –ó–∞–ø—Ä–æ—Å—ã –∫ –ë–î |
| `asterisk_stats_db_query_duration_seconds` | Histogram | –í—Ä–µ–º—è –∑–∞–ø—Ä–æ—Å–æ–≤ –ë–î |
| `asterisk_stats_active_queues` | Gauge | –ê–∫—Ç–∏–≤–Ω—ã–µ –æ—á–µ—Ä–µ–¥–∏ |
| `asterisk_stats_calls_processed_total` | Counter | –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∑–≤–æ–Ω–∫–∏ |
| `asterisk_stats_emails_sent_total` | Counter | –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ email |

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Prometheus

```yaml
# prometheus.yml
scrape_configs:
  - job_name: 'asterisk-stats'
    static_configs:
      - targets: ['localhost:3000']
    metrics_path: '/api/metrics'
    scrape_interval: 15s
```

#### Health Checks

```bash
# –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (–≤–∫–ª—é—á–∞—è –ë–î)
curl http://localhost:3000/api/health

# Liveness (–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ)
curl http://localhost:3000/api/health/live

# Readiness (–≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ)
curl http://localhost:3000/api/health/ready
```

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
asterisk-stats/
‚îú‚îÄ‚îÄ üìÑ app.js                    # –ì–ª–∞–≤–Ω—ã–π —Å–µ—Ä–≤–µ—Ä (Express)
‚îú‚îÄ‚îÄ üìÑ swagger.js                # Swagger/OpenAPI –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ üìÑ metrics.js                # Prometheus –º–µ—Ç—Ä–∏–∫–∏
‚îú‚îÄ‚îÄ üìÑ logger.js                 # Winston –ª–æ–≥–≥–µ—Ä
‚îú‚îÄ‚îÄ üìÅ routes/                   # API –º–∞—Ä—à—Ä—É—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ health.js               # Health checks
‚îÇ   ‚îú‚îÄ‚îÄ rankings.js             # –†–µ–π—Ç–∏–Ω–≥ –æ—á–µ—Ä–µ–¥–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ settings.js             # –ù–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ email-reports.js        # Email –æ—Ç—á–µ—Ç—ã
‚îú‚îÄ‚îÄ üìÅ views/                    # EJS —à–∞–±–ª–æ–Ω—ã
‚îÇ   ‚îú‚îÄ‚îÄ index.ejs               # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îú‚îÄ‚îÄ rankings.ejs            # –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ partials/               # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ üìÅ public/                   # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ css/style.css           # –¢–µ–º–Ω–∞—è —Ç–µ–º–∞
‚îÇ   ‚îî‚îÄ‚îÄ js/                     # –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π JavaScript
‚îú‚îÄ‚îÄ üìÅ sql/                      # SQL —Å–∫—Ä–∏–ø—Ç—ã
‚îú‚îÄ‚îÄ üìÅ db-adapters/              # –ê–¥–∞–ø—Ç–µ—Ä—ã –ë–î
‚îú‚îÄ‚îÄ üìÅ .github/workflows/        # CI/CD
‚îú‚îÄ‚îÄ üìÑ Dockerfile                # Docker –æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ üìÑ docker-compose.yml        # Docker Compose
‚îî‚îÄ‚îÄ üìÑ .env.example              # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```

---

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

<table>
<tr>
<td align="center" width="120">
  <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/nodejs/nodejs-original.svg" width="48" height="48" alt="Node.js" />
  <br />Node.js
</td>
<td align="center" width="120">
  <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/express/express-original.svg" width="48" height="48" alt="Express" />
  <br />Express.js
</td>
<td align="center" width="120">
  <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/mysql/mysql-original.svg" width="48" height="48" alt="MySQL" />
  <br />MySQL2
</td>
<td align="center" width="120">
  <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/javascript/javascript-original.svg" width="48" height="48" alt="JavaScript" />
  <br />JavaScript
</td>
</tr>
</table>

**Backend:**
- Node.js 16+ / Express.js 4.x
- MySQL2 —Å connection pooling
- Nodemailer –¥–ª—è email-–æ—Ç—á–µ—Ç–æ–≤
- Node-cron –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞—á
- Winston –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- Swagger/OpenAPI –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

**Frontend:**
- EJS —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä
- Vanilla JavaScript (ES6+)
- Chart.js –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π CSS (—Ç–µ–º–Ω–∞—è —Ç–µ–º–∞)

**DevOps:**
- Docker & Docker Compose
- GitHub Actions CI/CD
- Prometheus –º–µ—Ç—Ä–∏–∫–∏
- Health check endpoints

**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
- MySQL/MariaDB (–æ—Å–Ω–æ–≤–Ω–∞—è)
- SQLite (–Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
- –¢–∞–±–ª–∏—Ü—ã: `cdr`, `queuelog`, `email_reports`

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π (prepared statements)
- ‚úÖ Rate limiting –¥–ª—è API endpoints
- ‚úÖ Helmet.js –¥–ª—è –∑–∞—â–∏—Ç—ã HTTP –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- ‚ö° **Connection Pooling** ‚Äî —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å –ë–î
- ‚ö° **Batch Processing** ‚Äî –≥—Ä—É–ø–ø–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚ö° **Gzip Compression** ‚Äî —Å–∂–∞—Ç–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ —Å–µ—Ä–≤–µ—Ä–∞
- ‚ö° **Query Optimization** ‚Äî –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ SQL-–∑–∞–ø—Ä–æ—Å—ã
- ‚ö° **Caching** ‚Äî –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –æ—á–µ—Ä–µ–¥–µ–π

### –ú–µ—Ç—Ä–∏–∫–∏ —Ä–∞—Å—á–µ—Ç–∞

- üìà **ASA (Average Speed of Answer)** ‚Äî —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
- üìâ **Abandon Rate** ‚Äî –ø—Ä–æ—Ü–µ–Ω—Ç –∑–∞–±—Ä–æ—à–µ–Ω–Ω—ã—Ö –∑–≤–æ–Ω–∫–æ–≤
- üìä **SLA Compliance** ‚Äî —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ SLA (20 —Å–µ–∫—É–Ω–¥)
- üîÑ **Callback Rate** ‚Äî –ø—Ä–æ—Ü–µ–Ω—Ç –ø–µ—Ä–µ–∑–≤–æ–Ω–æ–≤

---

## üß™ –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```bash
npm run dev  # –° –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

#### –¢–∞–±–ª–∏—Ü–∞ `cdr`
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–≤–æ–Ω–∫–∞—Ö
- –°—Ç–∞—Ç—É—Å—ã, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –Ω–æ–º–µ—Ä–∞

#### –¢–∞–±–ª–∏—Ü–∞ `queuelog`
- –°–æ–±—ã—Ç–∏—è –æ—á–µ—Ä–µ–¥–µ–π
- –í—Ä–µ–º—è –≤—Ö–æ–¥–∞, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

#### –¢–∞–±–ª–∏—Ü–∞ `email_reports`
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ email-–æ—Ç—á–µ—Ç–æ–≤
- –ü—Ä–∏–≤—è–∑–∫–∞ –æ—á–µ—Ä–µ–¥–µ–π –∫ –ø–æ–ª—É—á–∞—Ç–µ–ª—è–º

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ [MIT License](LICENSE).

---

## üë§ –ê–≤—Ç–æ—Ä

**maerty1**

- GitHub: [@maerty1](https://github.com/maerty1)

---

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è Pull Requests! 

1. Fork –ø—Ä–æ–µ–∫—Ç–∞
2. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É (`git checkout -b feature/AmazingFeature`)
3. –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m 'Add AmazingFeature'`)
4. Push –≤ –≤–µ—Ç–∫—É (`git push origin feature/AmazingFeature`)
5. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

- üêõ [–°–æ–∑–¥–∞–π—Ç–µ Issue](https://github.com/maerty1/asterisk-stats/issues) –¥–ª—è –±–∞–≥–æ–≤
- üí° [–ü—Ä–µ–¥–ª–æ–∂–∏—Ç–µ —É–ª—É—á—à–µ–Ω–∏–µ](https://github.com/maerty1/asterisk-stats/issues/new) –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- üìö –ü—Ä–æ–≤–µ—Ä—å—Ç–µ [CHANGELOG.md](CHANGELOG.md) –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

<div align="center">

**‚≠ê –ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –±—ã–ª –ø–æ–ª–µ–∑–µ–Ω, –ø–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥—É!**

Made with ‚ù§Ô∏è by [maerty1](https://github.com/maerty1)

</div>
