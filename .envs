# ==========================================
# Asterisk Queue Analytics - Configuration
# ==========================================
# Скопируйте этот файл в .env и заполните реальными значениями
# cp .env.example .env

# ==========================================
# Database Configuration
# ==========================================
DB_HOST=localhost
DB_USER=freepbxuser
DB_PASS=H15g7nXMCTsg
DB_NAME=asterisk

# ==========================================
# Database Optimization Settings
# ==========================================
# Максимальное количество соединений в пуле (по умолчанию: 20)
# Увеличьте для параллельной обработки множественных очередей
DB_CONNECTION_LIMIT=20

# ==========================================
# Database Adapter Selection
# ==========================================
# Доступные адаптеры: mysql2, sequelize, knex, objection, bookshelf, typeorm, prisma
# По умолчанию: mysql2
# Примечание:
#   - mysql2 - нативный драйвер MySQL (рекомендуется для production, максимальная производительность)
#   - sequelize - популярный ORM для Node.js
#   - knex - SQL query builder
#   - objection - ORM основанный на Knex
#   - bookshelf - ORM основанный на Knex
#   - typeorm - ORM с поддержкой TypeScript
#   - prisma - современный ORM с type safety (требует настройки schema.prisma)
DB_ADAPTER=sequelize


# TTL кэша списка очередей в миллисекундах (по умолчанию: 3600000 = 1 час)
QUEUES_CACHE_TTL=3600000

# ==========================================
# Outbound Calls Filter Configuration
# ==========================================
# Минимальная длина номера для определения исходящих звонков
# Исходящие = короткий src (<= OUTBOUND_MIN_LENGTH) -> длинный dst (> OUTBOUND_MIN_LENGTH)
OUTBOUND_MIN_LENGTH=4

# ==========================================
# Email Configuration (для ежедневных отчетов)
# ==========================================
# SMTP настройки для отправки ежедневных отчетов
# Пример для Gmail:
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
# Для Gmail нужно использовать App Password (не обычный пароль)
# Настройка: https://support.google.com/accounts/answer/185833
SMTP_USER=your_email@gmail.com
SMTP_PASS=your_app_password_here

# Получатели ежедневных отчетов (через запятую, без пробелов)
# Пример: EMAIL_RECIPIENTS=manager@company.com,supervisor@company.com
EMAIL_RECIPIENTS=recipient1@example.com,recipient2@example.com

# Имя отправителя в письмах
EMAIL_FROM_NAME=Asterisk Analytics

# Расписание отправки отчетов (cron формат: секунда минута час день месяц день_недели)
# По умолчанию: каждый день в 23:59
# Примеры:
#   59 23 * * *     - каждый день в 23:59
#   0 0 * * *       - каждый день в 00:00 (полночь)
#   0 18 * * 1-5    - каждый рабочий день (пн-пт) в 18:00
#   0 9 * * 1       - каждый понедельник в 09:00
EMAIL_CRON_SCHEDULE=59 23 * * *

# Часовой пояс для cron расписания
TZ=Europe/Moscow

# ==========================================
# Server Configuration
# ==========================================
PORT=3000

# ==========================================
# Debug Configuration
# ==========================================
# Включить детальное логирование (true/false)
DEBUG=false

# ==========================================
# Recordings Path (опционально)
# ==========================================
# Путь к директории с записями звонков
RECORDINGS_PATH=/var/spool/asterisk/monitor

# ==========================================
# MySQL Parallel Processing (для многопоточности)
# ==========================================
# Включить параллельные запросы (разбиение на чанки)
USE_PARALLEL_QUERIES=true

# Размер временного чанка в часах (для разбиения периодов)
DB_TIME_CHUNK_HOURS=4

# Максимальное количество параллельных запросов
DB_MAX_PARALLEL=8

# Размер чанка для batch-запросов (количество элементов)
DB_BATCH_CHUNK_SIZE=50

# Включить отладку БД запросов
DEBUG_DB=false

# ==========================================
# Large Data Optimization (для больших таблиц в MariaDB)
# ==========================================
# Использовать оптимизированные запросы для больших данных
# (временные таблицы, оптимизация JOIN, EXISTS вместо JOIN)
USE_LARGE_DATA_OPTIMIZATION=false

# Prisma Database URL (для Prisma адаптера)
DATABASE_URL="mysql://freepbxuser:H15g7nXMCTsg@localhost:3306/asterisk"

# Ultra-fast queries optimization (рекомендуется включить)
# Использует 2 запроса + Map в памяти вместо медленного JOIN
# Ускоряет запросы в 228 раз (с ~766 секунд до ~3-7 секунд)
USE_ULTRA_FAST_QUERIES=true
