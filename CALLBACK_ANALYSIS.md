# –ê–Ω–∞–ª–∏–∑ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–µ—Ä–µ–∑–≤–æ–Ω–æ–≤ –≤ ruk-stats

## üìã –û–±–∑–æ—Ä

–í –ø—Ä–æ–µ–∫—Ç–µ ruk-stats —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–µ—Ä–µ–∑–≤–æ–Ω–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –∞–≥–µ–Ω—Ç–æ–≤. –°–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç:
1. **–ü–µ—Ä–µ–∑–≤–æ–Ω–∏–ª —Å–∞–º** - –∫–ª–∏–µ–Ω—Ç –ø–µ—Ä–µ–∑–≤–æ–Ω–∏–ª –ø–æ—Å–ª–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω–æ–≥–æ –∑–≤–æ–Ω–∫–∞
2. **–ü–µ—Ä–µ–∑–≤–æ–Ω–∏–ª–∏ –º—ã** - –∞–≥–µ–Ω—Ç –ø–µ—Ä–µ–∑–≤–æ–Ω–∏–ª –∫–ª–∏–µ–Ω—Ç—É –ø–æ—Å–ª–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω–æ–≥–æ –∑–≤–æ–Ω–∫–∞
3. **–ù–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω** - –∑–≤–æ–Ω–æ–∫ –æ—Å—Ç–∞–ª—Å—è –±–µ–∑ –ø–µ—Ä–µ–∑–≤–æ–Ω–∞

---

## üîç –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

–î–ª—è –∫–∞–∂–¥–æ–≥–æ **–ø—Ä–æ–ø—É—â–µ–Ω–Ω–æ–≥–æ** –∑–≤–æ–Ω–∫–∞ (–∫–æ–≥–¥–∞ `EVENT <> 'COMPLETECALLER' AND EVENT <> 'COMPLETEAGENT' OR dur <= 5`):
- –í—Ä–µ–º—è –ø—Ä–æ–ø—É—â–µ–Ω–Ω–æ–≥–æ –∑–≤–æ–Ω–∫–∞: `$row_in['time']`
- –ù–æ–º–µ—Ä –∫–ª–∏–µ–Ω—Ç–∞: `$row_in['src']` (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 —Ü–∏—Ñ—Ä)

### –í—Ä–µ–º–µ–Ω–Ω–æ–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø–æ–∏—Å–∫–∞

```php
$call_date_in_start = date('Y-m-d H:i:s', strtotime($row_in['time']) + 1); // –ù–∞—á–∞–ª–æ: +1 —Å–µ–∫—É–Ω–¥–∞
$call_date_in_end = date('Y-m-d H:i:s', strtotime($row_in['time']) + $time_hours); // –ö–æ–Ω–µ—Ü: +N —á–∞—Å–æ–≤
```

**–í–∞–∂–Ω–æ:** –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `$time_hours` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤ –∫–æ–¥–µ:
```php
$time_hours = 2; // –ì–ª—É–±–∏–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –∑–≤–æ–Ω–∫–∞ (–≤ —á–∞—Å–∞—Ö)
$time_hours = $time_hours * 3600; // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ —Å–µ–∫—É–Ω–¥—ã –¥–ª—è strtotime
```
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–∑–≤–æ–Ω–æ–≤ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ **2 —á–∞—Å–æ–≤** –ø–æ—Å–ª–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω–æ–≥–æ –∑–≤–æ–Ω–∫–∞.

---

## üìÅ –§–∞–π–ª—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. `in_caller_filter.php` - –ü—Ä–æ–≤–µ—Ä–∫–∞ "–ü–µ—Ä–µ–∑–≤–æ–Ω–∏–ª —Å–∞–º"

**–õ–æ–≥–∏–∫–∞:**
–ò—â–µ—Ç –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –ø–µ—Ä–µ–∑–≤–æ–Ω–∏–ª –ª–∏ –∫–ª–∏–µ–Ω—Ç —Å–∞–º –ø–æ—Å–ª–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω–æ–≥–æ –∑–≤–æ–Ω–∫–∞.

**SQL –∑–∞–ø—Ä–æ—Å:**
```sql
SELECT 
    queuelog.time, 
    queuelog.callid, 
    queuelog.queuename, 
    queuelog.agent, 
    queuelog.EVENT, 
    queuelog.data1 AS wait, 
    queuelog.data2 AS dur, 
    cdr.did, 
    cdr.src, 
    cdr.recordingfile, 
    cdr.disposition 
FROM 
    asteriskcdrdb.queuelog, 
    asteriskcdrdb.cdr 
WHERE 
    (cdr.channel LIKE 'PJSIP%' OR cdr.channel LIKE 'SIP%')
    AND queuelog.time >= :start 
    AND queuelog.time <= :end 
    AND cdr.src LIKE :src  -- –ù–æ–º–µ—Ä —Å–æ–≤–ø–∞–¥–∞–µ—Ç
    AND queuelog.callid = cdr.uniqueid 
    AND queuelog.`EVENT` IN ('COMPLETECALLER', 'COMPLETEAGENT') -- –ó–≤–æ–Ω–æ–∫ –∑–∞–≤–µ—Ä—à–µ–Ω
    AND LENGTH(cdr.src) >= 5 
    AND LENGTH(cdr.did) >= 4 
    AND queuelog.data2 > 1  -- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å > 1 —Å–µ–∫—É–Ω–¥—ã
GROUP BY cdr.linkedid 
ORDER BY queuelog.time 
LIMIT 1;
```

**–£—Å–ª–æ–≤–∏—è –¥–ª—è "–ü–µ—Ä–µ–∑–≤–æ–Ω–∏–ª —Å–∞–º":**
```php
if (
    (($res_in_filter['0']['EVENT'] == 'COMPLETECALLER') AND ($res_in_filter['0']['EVENT'] == 'COMPLETEAGENT'))
    OR ($res_in_filter['0']['dur'] >= 5)
) {
    $row_in['disposition'] = '–ü–µ—Ä–µ–∑–≤–æ–Ω–∏–ª —Å–∞–º';
    $client_recall++; // –°—á–µ—Ç—á–∏–∫
}
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –õ–æ–≥–∏–∫–∞ —É—Å–ª–æ–≤–∏—è –≤—ã–≥–ª—è–¥–∏—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (–ø—Ä–æ–≤–µ—Ä–∫–∞ `EVENT == 'COMPLETECALLER' AND EVENT == 'COMPLETEAGENT'` –≤—Å–µ–≥–¥–∞ false). –í–µ—Ä–æ—è—Ç–Ω–æ, –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `OR` –≤–º–µ—Å—Ç–æ `AND`.

### 2. `out_caller_filter.php` - –ü—Ä–æ–≤–µ—Ä–∫–∞ "–ü–µ—Ä–µ–∑–≤–æ–Ω–∏–ª–∏ –º—ã"

**–í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ `in_caller_filter.php`** —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –Ω–µ –ø–µ—Ä–µ–∑–≤–æ–Ω–∏–ª —Å–∞–º.

**–õ–æ–≥–∏–∫–∞:**
–ò—â–µ—Ç –∏—Å—Ö–æ–¥—è—â–∏–µ –∑–≤–æ–Ω–∫–∏ –æ—Ç –∞–≥–µ–Ω—Ç–æ–≤ –∫ –∫–ª–∏–µ–Ω—Ç—É.

**SQL –∑–∞–ø—Ä–æ—Å:**
```sql
SELECT 
    cdr.calldate, 
    cdr.uniqueid, 
    cdr.billsec, 
    cdr.disposition, 
    cdr.outbound_cnum, 
    cdr.cnum, 
    cdr.dst_cnam, 
    cdr.recordingfile, 
    cdr.src, 
    cdr.dst,  -- –ù–æ–º–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è (–∫–ª–∏–µ–Ω—Ç)
    cdr.linkedid, 
    cdr.clid, 
    cdr.cnam 
FROM asteriskcdrdb.cdr 
WHERE 
    cdr.calldate >= :start_out 
    AND cdr.calldate <= :end_out 
    AND cdr.dst LIKE :dst_out  -- –ù–æ–º–µ—Ä –∫–ª–∏–µ–Ω—Ç–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç
    AND cdr.disposition = 'ANSWERED'  -- –ó–≤–æ–Ω–æ–∫ –æ—Ç–≤–µ—Ç–ª–µ–Ω
GROUP BY cdr.uniqueid 
ORDER BY cdr.calldate;
```

**–£—Å–ª–æ–≤–∏—è –¥–ª—è "–ü–µ—Ä–µ–∑–≤–æ–Ω–∏–ª–∏ –º—ã":**
```php
if ($res_out_filter['0']['disposition'] == 'ANSWERED') {
    $row_in['disposition'] = '–ü–µ—Ä–µ–∑–≤–æ–Ω–∏–ª–∏ –º—ã';
    $agent_recall++; // –°—á–µ—Ç—á–∏–∫
}
```

**–£—Å–ª–æ–≤–∏—è –¥–ª—è "–ù–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω":**
```php
if ($res_out_filter['0']['disposition'] <> 'ANSWERED') {
    $row_in['disposition'] = '–ù–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω';
    $no_recall++; // –°—á–µ—Ç—á–∏–∫
}
```

---

## üé® –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (—Ç–∞–±–ª–∏—Ü–∞):
```php
<TD>–ò–∑ –Ω–∏—Ö –ø–µ—Ä–µ–∑–≤–æ–Ω–∏–ª–∏ —Å–∞–º–∏:</TD>
<TD><?php echo $client_recall ?> <?php echo $lang["$language"]['calls'] ?></TD>

<TD>–ò–∑ –Ω–∏—Ö –ø–µ—Ä–µ–∑–≤–æ–Ω–∏–ª–∏ –º—ã:</TD>
<TD><?php echo $agent_recall ?> <?php echo $lang["$language"]['calls'] ?></TD>

<TD>–û—Å—Ç–∞–ª–∏—Å—å –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ:</TD>
<TD><?php echo $no_recall ?> <?php echo $lang["$language"]['calls'] ?></TD>
```

### –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è –≤ —Ç–∞–±–ª–∏—Ü–µ –∑–≤–æ–Ω–∫–æ–≤:
```php
if ($items_in['disposition'] == '–ü–µ—Ä–µ–∑–≤–æ–Ω–∏–ª —Å–∞–º') {
    echo '<span style="color: Orange">–ü–µ—Ä–µ–∑–≤–æ–Ω–∏–ª —Å–∞–º</span>';
}
if ($items_in['disposition'] == '–ü–µ—Ä–µ–∑–≤–æ–Ω–∏–ª–∏ –º—ã') {
    echo '<span style="color: Teal">–ü–µ—Ä–µ–∑–≤–æ–Ω–∏–ª–∏ –º—ã</span>';
}
if ($items_in['disposition'] == '–ù–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω') {
    echo '<span style="color: red">–ù–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω</span>';
}
```

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü—ã –ë–î:
1. **asteriskcdrdb.queuelog** - –ª–æ–≥–∏ –æ—á–µ—Ä–µ–¥–µ–π
   - `time` - –≤—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è
   - `callid` - ID –∑–≤–æ–Ω–∫–∞
   - `queuename` - –Ω–∞–∑–≤–∞–Ω–∏–µ –æ—á–µ—Ä–µ–¥–∏
   - `agent` - –∞–≥–µ–Ω—Ç
   - `EVENT` - —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è ('COMPLETECALLER', 'COMPLETEAGENT', –∏ –¥—Ä.)
   - `data1` - –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è (wait)
   - `data2` - –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä–∞ (dur)

2. **asteriskcdrdb.cdr** - –∑–∞–ø–∏—Å–∏ –∑–≤–æ–Ω–∫–æ–≤
   - `calldate` - –¥–∞—Ç–∞/–≤—Ä–µ–º—è –∑–≤–æ–Ω–∫–∞
   - `uniqueid` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID
   - `src` - –Ω–æ–º–µ—Ä –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (–∫–ª–∏–µ–Ω—Ç)
   - `dst` - –Ω–æ–º–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
   - `disposition` - —Å—Ç–∞—Ç—É—Å ('ANSWERED', 'NO ANSWER', –∏ –¥—Ä.)
   - `recordingfile` - —Ñ–∞–π–ª –∑–∞–ø–∏—Å–∏
   - `linkedid` - —Å–≤—è–∑–∞–Ω–Ω—ã–π ID

---

## üîÑ –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏:

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∑–≤–æ–Ω–∫–∞:**
   - –ï—Å–ª–∏ `EVENT = 'COMPLETECALLER' OR 'COMPLETEAGENT' AND dur > 5` ‚Üí **"–ü—Ä–∏–Ω—è—Ç–æ —É—Å–ø–µ—à–Ω–æ"**
   - –ò–Ω–∞—á–µ ‚Üí –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –ø—Ä–æ–≤–µ—Ä–∫–µ –ø–µ—Ä–µ–∑–≤–æ–Ω–æ–≤

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ "–ü–µ—Ä–µ–∑–≤–æ–Ω–∏–ª —Å–∞–º" (`in_caller_filter.php`):**
   - –ò—â–µ–º –≤—Ö–æ–¥—è—â–∏–µ –∑–≤–æ–Ω–∫–∏ –æ—Ç —Ç–æ–≥–æ –∂–µ –Ω–æ–º–µ—Ä–∞ (`src`)
   - –í –≤—Ä–µ–º–µ–Ω–Ω–æ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ `[time + 1 —Å–µ–∫, time + N —á–∞—Å–æ–≤]`
   - –° `EVENT = 'COMPLETECALLER' OR 'COMPLETEAGENT'`
   - –° `dur >= 5` —Å–µ–∫—É–Ω–¥
   - –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ ‚Üí **"–ü–µ—Ä–µ–∑–≤–æ–Ω–∏–ª —Å–∞–º"**

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ "–ü–µ—Ä–µ–∑–≤–æ–Ω–∏–ª–∏ –º—ã" (`out_caller_filter.php`):**
   - –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –Ω–µ –ø–µ—Ä–µ–∑–≤–æ–Ω–∏–ª —Å–∞–º
   - –ò—â–µ–º –∏—Å—Ö–æ–¥—è—â–∏–µ –∑–≤–æ–Ω–∫–∏ –∫ –Ω–æ–º–µ—Ä—É –∫–ª–∏–µ–Ω—Ç–∞ (`dst`)
   - –í —Ç–æ–º –∂–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ
   - –° `disposition = 'ANSWERED'`
   - –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ ‚Üí **"–ü–µ—Ä–µ–∑–≤–æ–Ω–∏–ª–∏ –º—ã"**
   - –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Üí **"–ù–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω"**

---

## üí° –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã

1. **–í—Ä–µ–º–µ–Ω–Ω–æ–π –∏–Ω—Ç–µ—Ä–≤–∞–ª:** –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 2 —á–∞—Å–∞ (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `$time_hours = 2`)
2. **–ù–æ–º–µ—Ä–∞:** –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 —Ü–∏—Ñ—Ä –Ω–æ–º–µ—Ä–∞ (`mb_substr($src, -10)`)
3. **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è "—É—Å–ø–µ—à–Ω–æ–≥–æ" –∑–≤–æ–Ω–∫–∞ - 5 —Å–µ–∫—É–Ω–¥
4. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è "–ü–µ—Ä–µ–∑–≤–æ–Ω–∏–ª —Å–∞–º", –∑–∞—Ç–µ–º "–ü–µ—Ä–µ–∑–≤–æ–Ω–∏–ª–∏ –º—ã"
5. **–ó–∞–ø–∏—Å–∏:** –î–ª—è –ø–µ—Ä–µ–∑–≤–æ–Ω–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `recordingfile` –∏–∑ –Ω–∞–π–¥–µ–Ω–Ω–æ–π –∑–∞–ø–∏—Å–∏

---

## üîß –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É —É—Å–ª–æ–≤–∏—è** –≤ `in_caller_filter.php`:
   ```php
   // –¢–µ–∫—É—â–µ–µ (–Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ):
   if (($res_in_filter['0']['EVENT'] == 'COMPLETECALLER') AND ($res_in_filter['0']['EVENT'] == 'COMPLETEAGENT'))
   
   // –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ:
   if (($res_in_filter['0']['EVENT'] == 'COMPLETECALLER') OR ($res_in_filter['0']['EVENT'] == 'COMPLETEAGENT'))
   ```

2. **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É** –Ω–∞ –ø—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø—Ä–æ—Å–∞ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `$res_in_filter['0']`

3. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã** - –≤–æ–∑–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å JOIN –≤–º–µ—Å—Ç–æ –¥–≤—É—Ö –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

---

## üìù –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–¥–µ

```php
// –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω–æ–≥–æ –∑–≤–æ–Ω–∫–∞
foreach ($res_in as $row_in) {
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∏–Ω—Ç–µ—Ä–≤–∞–ª
    $call_date_in_start = date('Y-m-d H:i:s', strtotime($row_in['time']) + 1);
    $call_date_in_end = date('Y-m-d H:i:s', strtotime($row_in['time']) + $time_hours);
    $call_date_in_src = mb_substr($row_in['src'], -10);
    
    // –ï—Å–ª–∏ –∑–≤–æ–Ω–æ–∫ –ø—Ä–æ–ø—É—â–µ–Ω
    if ((($row_in['EVENT'] <> 'COMPLETECALLER') and ($row_in['EVENT'] <> 'COMPLETEAGENT')) 
        or ($row_in['dur'] <= 5)) {
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–µ–∑–≤–æ–Ω—ã
        require "in_caller_filter.php";  // –ü—Ä–æ–≤–µ—Ä–∫–∞ "–ü–µ—Ä–µ–∑–≤–æ–Ω–∏–ª —Å–∞–º"
        // out_caller_filter.php –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ in_caller_filter.php –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
    }
}
```

---

*–ê–Ω–∞–ª–∏–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–¥–∞ –∏–∑ `/var/www/html/ruk-stats/`*

